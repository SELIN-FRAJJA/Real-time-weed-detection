def detect_weed_realtime(video_source=0):
    # Open video capture
    cap = cv2.VideoCapture(video_source)

    while True:
        # Read frame from the video capture
        ret, frame = cap.read()
        if not ret:
            break

        # Convert frame to RGB
        img = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)

        # Perform detection
        results = model(img)

        # Render results on the frame
        results.render()
        result_img = results.ims[0]

        # Convert result image back to BGR
        result_img = cv2.cvtColor(result_img, cv2.COLOR_RGB2BGR)

        # Display the frame with detections
        cv2.imshow('Real-Time Weed Detection', result_img)

        # Break the loop on 'q' key press
        if cv2.waitKey(1) & 0xFF == ord('q'):
            break

    # Release video capture and close windows
    cap.release()
    cv2.destroyAllWindows()

# Call the detection function
detect_weed_realtime()